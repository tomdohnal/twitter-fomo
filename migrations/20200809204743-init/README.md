# Migration `20200809204743-init`

This migration has been generated by Tom Dohnal at 8/9/2020, 10:47:43 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "AccountType" AS ENUM ('PERSONAL', 'BUSINESS');

CREATE TYPE "TweetType" AS ENUM ('TEXT', 'MEDIA', 'LINK');

CREATE TYPE "Period" AS ENUM ('DAY', 'WEEK');

CREATE TABLE "public"."Community" (
"id" SERIAL,
"name" text  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)  NOT NULL ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."Account" (
"id" SERIAL,
"name" text  NOT NULL ,
"twitterId" text  NOT NULL ,
"type" "AccountType" NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)  NOT NULL ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."TweetHashtag" (
"id" SERIAL,
"text" text  NOT NULL ,
"indices" integer []  ,
"tweetId" integer  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)  NOT NULL ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."TweetMediaSize" (
"id" SERIAL,
"width" integer  NOT NULL ,
"height" integer  NOT NULL ,
"resize" text  NOT NULL ,
"tweetMediaId" integer  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)  NOT NULL ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."TweetMedia" (
"id" SERIAL,
"displayUrl" text  NOT NULL ,
"expandedUrl" text  NOT NULL ,
"indices" integer []  ,
"mediaUrl" text  NOT NULL ,
"mediaUrlHttps" text  NOT NULL ,
"type" text  NOT NULL ,
"url" text  NOT NULL ,
"tweetId" integer  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)  NOT NULL ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."TweetUnwoundUrl" (
"id" SERIAL,
"url" text  NOT NULL ,
"status" integer  NOT NULL ,
"title" text  NOT NULL ,
"description" text  NOT NULL ,
"tweetUrlId" integer  NOT NULL ,
"tweetId" integer  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)  NOT NULL ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."TweetUrl" (
"id" SERIAL,
"displayUrl" text  NOT NULL ,
"expandedUrl" text  NOT NULL ,
"indices" integer []  ,
"url" text  NOT NULL ,
"tweetId" integer  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)  NOT NULL ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."TweetUserMention" (
"id" SERIAL,
"indices" integer []  ,
"name" text  NOT NULL ,
"screenName" text  NOT NULL ,
"tweetId" integer  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)  NOT NULL ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."TweetSymbol" (
"id" SERIAL,
"indices" integer []  ,
"text" text  NOT NULL ,
"tweetId" integer  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)  NOT NULL ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."Tweet" (
"id" SERIAL,
"twitterId" text  NOT NULL ,
"publishedAt" timestamp(3)  NOT NULL ,
"text" text  NOT NULL ,
"accountName" text  NOT NULL ,
"accountId" integer  NOT NULL ,
"favoritesCount" integer  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)  NOT NULL ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."List" (
"id" SERIAL,
"accountType" "AccountType"  ,
"tweetType" "TweetType"  ,
"period" "Period" NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)  NOT NULL ,
"communityId" integer  NOT NULL ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."_AccountToCommunity" (
"A" integer  NOT NULL ,
"B" integer  NOT NULL )

CREATE TABLE "public"."_ListToTweet" (
"A" integer  NOT NULL ,
"B" integer  NOT NULL )

CREATE UNIQUE INDEX "Community.name_unique" ON "public"."Community"("name")

CREATE UNIQUE INDEX "Account.name_unique" ON "public"."Account"("name")

CREATE UNIQUE INDEX "Account.twitterId_unique" ON "public"."Account"("twitterId")

CREATE UNIQUE INDEX "TweetUnwoundUrl_tweetUrlId" ON "public"."TweetUnwoundUrl"("tweetUrlId")

CREATE UNIQUE INDEX "_AccountToCommunity_AB_unique" ON "public"."_AccountToCommunity"("A","B")

CREATE  INDEX "_AccountToCommunity_B_index" ON "public"."_AccountToCommunity"("B")

CREATE UNIQUE INDEX "_ListToTweet_AB_unique" ON "public"."_ListToTweet"("A","B")

CREATE  INDEX "_ListToTweet_B_index" ON "public"."_ListToTweet"("B")

ALTER TABLE "public"."TweetHashtag" ADD FOREIGN KEY ("tweetId")REFERENCES "public"."Tweet"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."TweetMediaSize" ADD FOREIGN KEY ("tweetMediaId")REFERENCES "public"."TweetMedia"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."TweetMedia" ADD FOREIGN KEY ("tweetId")REFERENCES "public"."Tweet"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."TweetUnwoundUrl" ADD FOREIGN KEY ("tweetUrlId")REFERENCES "public"."TweetUrl"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."TweetUnwoundUrl" ADD FOREIGN KEY ("tweetId")REFERENCES "public"."Tweet"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."TweetUrl" ADD FOREIGN KEY ("tweetId")REFERENCES "public"."Tweet"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."TweetUserMention" ADD FOREIGN KEY ("tweetId")REFERENCES "public"."Tweet"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."TweetSymbol" ADD FOREIGN KEY ("tweetId")REFERENCES "public"."Tweet"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Tweet" ADD FOREIGN KEY ("accountId")REFERENCES "public"."Account"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."List" ADD FOREIGN KEY ("communityId")REFERENCES "public"."Community"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_AccountToCommunity" ADD FOREIGN KEY ("A")REFERENCES "public"."Account"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_AccountToCommunity" ADD FOREIGN KEY ("B")REFERENCES "public"."Community"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_ListToTweet" ADD FOREIGN KEY ("A")REFERENCES "public"."List"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_ListToTweet" ADD FOREIGN KEY ("B")REFERENCES "public"."Tweet"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200809204743-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,161 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider  =  "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+enum AccountType {
+  PERSONAL
+  BUSINESS // hard to find the right name, what I mean is just the oppostite of personal
+}
+
+enum TweetType {
+  TEXT
+  MEDIA
+  LINK
+}
+
+model Community {
+  id         Int        @id @default(autoincrement())
+  name       String     @unique
+  accounts   Account[]  @relation(references: [id])
+  createdAt  DateTime   @default(now())
+  updatedAt  DateTime   @updatedAt
+}
+
+model Account {
+  id           Int          @id @default(autoincrement())
+  name         String       @unique
+  twitterId    String       @unique
+  communities  Community[]  @relation(references: [id])
+  type         AccountType
+  createdAt    DateTime     @default(now())
+  updatedAt    DateTime     @updatedAt
+}
+
+model TweetHashtag {
+  id         Int       @id @default(autoincrement())
+  text       String
+  indices    Int[]
+  tweet      Tweet     @relation(fields: [tweetId], references: [id])
+  tweetId    Int
+  createdAt  DateTime  @default(now())
+  updatedAt  DateTime  @updatedAt
+}
+
+model TweetMediaSize {
+  id             Int         @id @default(autoincrement())
+  width          Int
+  height         Int
+  resize         String
+  tweetMedia     TweetMedia  @relation(fields: [tweetMediaId], references: [id])
+  tweetMediaId   Int
+  createdAt      DateTime    @default(now())
+  updatedAt      DateTime    @updatedAt
+}
+
+model TweetMedia {
+  id             Int                @id @default(autoincrement())
+  displayUrl     String
+  expandedUrl    String
+  indices        Int[]
+  mediaUrl       String
+  mediaUrlHttps  String
+  sizes          TweetMediaSize[]
+  type           String
+  url            String
+  tweet          Tweet              @relation(fields: [tweetId], references: [id])
+  tweetId        Int
+  createdAt      DateTime           @default(now())
+  updatedAt      DateTime           @updatedAt
+}
+
+model TweetUnwoundUrl {
+  id           Int       @id @default(autoincrement())
+  url          String
+  status       Int
+  title        String
+  description  String
+  tweetUrl     TweetUrl  @relation(fields: [tweetUrlId], references: [id])
+  tweetUrlId   Int
+  tweet        Tweet     @relation(fields: [tweetId], references: [id])
+  tweetId      Int
+  createdAt    DateTime  @default(now())
+  updatedAt    DateTime  @updatedAt
+}
+
+model TweetUrl {
+  id           Int               @id @default(autoincrement())
+  displayUrl   String
+  expandedUrl  String
+  indices      Int[]
+  url          String
+  unwound      TweetUnwoundUrl?
+  tweet        Tweet             @relation(fields: [tweetId], references: [id])
+  tweetId      Int
+  createdAt    DateTime          @default(now())
+  updatedAt    DateTime          @updatedAt
+}
+
+model TweetUserMention {
+  id           Int       @id @default(autoincrement())
+  indices      Int[]
+  name         String
+  screenName   String
+  tweet        Tweet     @relation(fields: [tweetId], references: [id])
+  tweetId      Int
+  createdAt    DateTime  @default(now())
+  updatedAt    DateTime  @updatedAt
+}
+
+model TweetSymbol {
+  id         Int       @id @default(autoincrement())
+  indices    Int[]
+  text       String
+  tweet      Tweet     @relation(fields: [tweetId], references: [id])
+  tweetId    Int
+  createdAt  DateTime  @default(now())
+  updatedAt  DateTime  @updatedAt
+}
+
+model Tweet {
+  id              Int                @id @default(autoincrement())
+  list            List[]
+  twitterId       String
+  publishedAt     DateTime
+  text            String
+  accountName     String
+  account         Account            @relation(fields: [accountId], references: [id])
+  accountId       Int
+  favoritesCount  Int
+  hashtags        TweetHashtag[]
+  media           TweetMedia[]
+  urls            TweetUrl[]
+  userMentions    TweetUserMention[]
+  symbols         TweetSymbol[]
+  createdAt       DateTime           @default(now())
+  updatedAt       DateTime           @updatedAt
+}
+
+enum Period {
+  DAY
+  WEEK
+}
+
+model List {
+  id           Int           @id @default(autoincrement())
+  community    Community     @relation(references: [id])
+  accountType  AccountType?
+  tweetType    TweetType?
+  tweets       Tweet[]       @relation(references: [id])
+  period       Period
+  createdAt    DateTime      @default(now())
+  updatedAt    DateTime      @updatedAt
+}
+
```


